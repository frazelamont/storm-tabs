(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _stormTabs = require('./libs/storm-tabs');

var _stormTabs2 = _interopRequireDefault(_stormTabs);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var onDOMContentLoadedTasks = [function () {
  _stormTabs2.default.init('.js-tabs');
}];

if ('addEventListener' in window) window.addEventListener('DOMContentLoaded', function () {
  onDOMContentLoadedTasks.forEach(function (fn) {
    return fn();
  });
});

},{"./libs/storm-tabs":2}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
/**
 * @name storm-tabs: Multi-panelled content areas 
 * @version 0.6.0: Mon, 21 Nov 2016 15:23:37 GMT
 * @author mjbp
 * @license MIT
 */
var KEY_CODES = {
	SPACE: 32,
	ENTER: 13,
	TAB: 9,
	LEFT: 37,
	RIGHT: 39,
	UP: 38,
	DOWN: 40
},
    defaults = {
	titleClass: '.js-tabs__link',
	currentClass: 'active',
	active: 0
},
    StormTabs = {
	init: function init() {
		var _this = this;

		var hash = location.hash.slice(1) || null;

		this.links = [].slice.call(this.DOMElement.querySelectorAll(this.settings.titleClass));
		this.targets = this.links.map(function (el) {
			return document.getElementById(el.getAttribute('href').substr(1)) || console.error('Tab target not found');
		});

		!!this.links.length && this.links[0].parentNode.setAttribute('role', 'tablist');

		this.current = this.settings.active;

		if (hash) {
			this.targets.forEach(function (target, i) {
				if (target.getAttribute('id') === hash) {
					_this.current = i;
				}
			});
		}

		this.initAria().initTitles().open(this.current);

		return this;
	},
	initAria: function initAria() {
		var _this2 = this;

		this.links.forEach(function (el, i) {
			el.setAttribute('role', 'tab');
			el.setAttribute('aria-expanded', false);
			el.setAttribute('aria-selected', false);
			el.setAttribute('aria-controls', _this2.targets[i].getAttribute('id'));
		});

		this.targets.forEach(function (el) {
			el.setAttribute('role', 'tabpanel');
			el.setAttribute('aria-hidden', true);
			el.setAttribute('tabIndex', '-1');
		});
		return this;
	},
	initTitles: function initTitles() {
		var _this3 = this;

		var handler = function handler(i) {
			_this3.toggle(i);
		};

		this.lastFocusedTab = 0;

		this.links.forEach(function (el, i) {
			//navigate
			el.addEventListener('keydown', function (e) {
				switch (e.keyCode) {
					case KEY_CODES.UP:
						e.preventDefault();
						_this3.toggle(_this3.current === 0 ? _this3.links.length - 1 : _this3.current - 1);
						window.setTimeout(function () {
							_this3.links[_this3.current].focus();
						}, 16);
						break;
					case KEY_CODES.LEFT:
						_this3.toggle(_this3.current === 0 ? _this3.links.length - 1 : _this3.current - 1);
						window.setTimeout(function () {
							_this3.links[_this3.current].focus();
						}, 16);
						break;
					case KEY_CODES.DOWN:
						e.preventDefault();
						_this3.toggle(_this3.current === _this3.links.length - 1 ? 0 : _this3.current + 1);
						window.setTimeout(function () {
							_this3.links[_this3.current].focus();
						}, 16);
						break;
					case KEY_CODES.RIGHT:
						_this3.toggle(_this3.current === _this3.links.length - 1 ? 0 : _this3.current + 1);
						window.setTimeout(function () {
							_this3.links[_this3.current].focus();
						}, 16);
						break;
					case KEY_CODES.ENTER:
						handler.call(_this3, i);
						window.setTimeout(function () {
							_this3.links[i].focus();
						}, 16);
						break;
					case KEY_CODES.SPACE:
						e.preventDefault();
						handler.call(_this3, i);
						window.setTimeout(function () {
							_this3.links[i].focus();
						}, 16);
						break;
					case KEY_CODES.TAB:
						e.preventDefault();
						e.stopPropagation();
						_this3.lastFocusedTab = _this3.getLinkIndex(e.target);
						_this3.setTargetFocus(_this3.lastFocusedTab);
						handler.call(_this3, i);
						break;
					default:
						//
						break;
				}
			});

			//toggle
			el.addEventListener('click', function (e) {
				e.preventDefault();
				handler.call(_this3, i);
			}, false);
		});

		return this;
	},
	getLinkIndex: function getLinkIndex(link) {
		for (var i = 0; i < this.links.length; i++) {
			if (link === this.links[i]) return i;
		}
		return null;
	},
	getFocusableChildren: function getFocusableChildren(node) {
		var focusableElements = ['a[href]', 'area[href]', 'input:not([disabled])', 'select:not([disabled])', 'textarea:not([disabled])', 'button:not([disabled])', 'iframe', 'object', 'embed', '[contenteditable]', '[tabIndex]:not([tabIndex="-1"])'];
		return [].slice.call(node.querySelectorAll(focusableElements.join(',')));
	},
	setTargetFocus: function setTargetFocus(tabIndex) {
		this.focusableChildren = this.getFocusableChildren(this.targets[tabIndex]);

		if (this.focusableChildren.length) {
			window.setTimeout(function () {
				this.focusableChildren[0].focus();
				this.keyEventListener = this.keyListener.bind(this);

				document.addEventListener('keydown', this.keyEventListener);
			}.bind(this), 0);
		}
	},
	keyListener: function keyListener(e) {
		if (e.keyCode !== KEY_CODES.TAB) {
			return;
		}
		var focusedIndex = this.focusableChildren.indexOf(document.activeElement);

		if (focusedIndex < 0) {
			document.removeEventListener('keydown', this.keyEventListener);
			return;
		}

		if (e.shiftKey && focusedIndex === 0) {
			e.preventDefault();
			this.focusableChildren[this.focusableChildren.length - 1].focus();
		} else {
			if (!e.shiftKey && focusedIndex === this.focusableChildren.length - 1) {
				document.removeEventListener('keydown', this.keyEventListener);
				if (this.lastFocusedTab !== this.links.length - 1) {
					e.preventDefault();
					this.lastFocusedTab = this.lastFocusedTab + 1;
					this.links[this.lastFocusedTab].focus();
				}
			}
		}
	},
	change: function change(type, i) {
		var methods = {
			open: {
				classlist: 'add',
				tabIndex: {
					target: this.targets[i],
					value: '0'
				}
			},
			close: {
				classlist: 'remove',
				tabIndex: {
					target: this.targets[this.current],
					value: '-1'
				}
			}
		};

		this.links[i].classList[methods[type].classlist](this.settings.currentClass);
		this.targets[i].classList[methods[type].classlist](this.settings.currentClass);
		this.targets[i].setAttribute('aria-hidden', !this.targets[i].getAttribute('aria-hidden'));
		this.links[i].setAttribute('aria-selected', !this.targets[i].getAttribute('aria-selected'));
		this.links[i].setAttribute('aria-expanded', !this.targets[i].getAttribute('aria-expanded'));
		methods[type].tabIndex.target.setAttribute('tabIndex', methods[type].tabIndex.value);
	},
	open: function open(i) {
		this.change('open', i);
		this.current = i;
		return this;
	},
	close: function close(i) {
		this.change('close', i);
		return this;
	},
	toggle: function toggle(i) {
		if (this.current === i) return;

		window.history.pushState({ URL: this.links[i].getAttribute('href') }, '', this.links[i].getAttribute('href'));

		if (this.current === null) {
			this.open(i);
			return this;
		}
		this.close(this.current).open(i);

		return this;
	}
};

var init = function init(sel, opts) {
	var els = [].slice.call(document.querySelectorAll(sel));

	if (!els.length) throw new Error('Tabs cannot be initialised, no augmentable elements found');

	return els.map(function (el) {
		return Object.assign(Object.create(StormTabs), {
			DOMElement: el,
			settings: Object.assign({}, defaults, opts)
		}).init();
	});
};

exports.default = { init: init };

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJleGFtcGxlL3NyYy9hcHAuanMiLCJleGFtcGxlL3NyYy9saWJzL3N0b3JtLXRhYnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBOzs7Ozs7QUFFQSxJQUFNLDBCQUEwQixDQUFDLFlBQU07QUFDdEMsc0JBQUssSUFBTCxDQUFVLFVBQVY7QUFDQSxDQUYrQixDQUFoQzs7QUFJQSxJQUFHLHNCQUFzQixNQUF6QixFQUFpQyxPQUFPLGdCQUFQLENBQXdCLGtCQUF4QixFQUE0QyxZQUFNO0FBQUUsMEJBQXdCLE9BQXhCLENBQWdDLFVBQUMsRUFBRDtBQUFBLFdBQVEsSUFBUjtBQUFBLEdBQWhDO0FBQWdELENBQXBHOzs7Ozs7OztBQ05qQzs7Ozs7O0FBTUEsSUFBTSxZQUFZO0FBQ2hCLFFBQU8sRUFEUztBQUVoQixRQUFPLEVBRlM7QUFHaEIsTUFBSyxDQUhXO0FBSWhCLE9BQU0sRUFKVTtBQUtoQixRQUFPLEVBTFM7QUFNaEIsS0FBRyxFQU5hO0FBT2hCLE9BQU07QUFQVSxDQUFsQjtBQUFBLElBU0MsV0FBVztBQUNWLGFBQVksZ0JBREY7QUFFVixlQUFjLFFBRko7QUFHVixTQUFRO0FBSEUsQ0FUWjtBQUFBLElBY0MsWUFBWTtBQUNYLEtBRFcsa0JBQ0o7QUFBQTs7QUFDTixNQUFJLE9BQU8sU0FBUyxJQUFULENBQWMsS0FBZCxDQUFvQixDQUFwQixLQUEwQixJQUFyQzs7QUFFQSxPQUFLLEtBQUwsR0FBYSxHQUFHLEtBQUgsQ0FBUyxJQUFULENBQWMsS0FBSyxVQUFMLENBQWdCLGdCQUFoQixDQUFpQyxLQUFLLFFBQUwsQ0FBYyxVQUEvQyxDQUFkLENBQWI7QUFDQSxPQUFLLE9BQUwsR0FBZSxLQUFLLEtBQUwsQ0FBVyxHQUFYLENBQWUsY0FBTTtBQUNuQyxVQUFPLFNBQVMsY0FBVCxDQUF3QixHQUFHLFlBQUgsQ0FBZ0IsTUFBaEIsRUFBd0IsTUFBeEIsQ0FB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bnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnQgVGFicyBmcm9tICcuL2xpYnMvc3Rvcm0tdGFicyc7XG5cbmNvbnN0IG9uRE9NQ29udGVudExvYWRlZFRhc2tzID0gWygpID0+IHtcblx0VGFicy5pbml0KCcuanMtdGFicycpO1xufV07XG4gICAgXG5pZignYWRkRXZlbnRMaXN0ZW5lcicgaW4gd2luZG93KSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsgb25ET01Db250ZW50TG9hZGVkVGFza3MuZm9yRWFjaCgoZm4pID0+IGZuKCkpOyB9KTsiLCIvKipcbiAqIEBuYW1lIHN0b3JtLXRhYnM6IE11bHRpLXBhbmVsbGVkIGNvbnRlbnQgYXJlYXMgXG4gKiBAdmVyc2lvbiAwLjYuMDogTW9uLCAyMSBOb3YgMjAxNiAxNToyMzozNyBHTVRcbiAqIEBhdXRob3IgbWpicFxuICogQGxpY2Vuc2UgTUlUXG4gKi9cbmNvbnN0IEtFWV9DT0RFUyA9IHtcblx0XHRTUEFDRTogMzIsXG5cdFx0RU5URVI6IDEzLFxuXHRcdFRBQjogOSxcblx0XHRMRUZUOiAzNyxcblx0XHRSSUdIVDogMzksXG5cdFx0VVA6MzgsXG5cdFx0RE9XTjogNDBcblx0fSxcblx0ZGVmYXVsdHMgPSB7XG5cdFx0dGl0bGVDbGFzczogJy5qcy10YWJzX19saW5rJyxcblx0XHRjdXJyZW50Q2xhc3M6ICdhY3RpdmUnLFxuXHRcdGFjdGl2ZTogMFxuXHR9LFxuXHRTdG9ybVRhYnMgPSB7XG5cdFx0aW5pdCgpIHtcblx0XHRcdGxldCBoYXNoID0gbG9jYXRpb24uaGFzaC5zbGljZSgxKSB8fCBudWxsO1xuXG5cdFx0XHR0aGlzLmxpbmtzID0gW10uc2xpY2UuY2FsbCh0aGlzLkRPTUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNldHRpbmdzLnRpdGxlQ2xhc3MpKTtcblx0XHRcdHRoaXMudGFyZ2V0cyA9IHRoaXMubGlua3MubWFwKGVsID0+IHtcblx0XHRcdFx0cmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsLmdldEF0dHJpYnV0ZSgnaHJlZicpLnN1YnN0cigxKSkgfHwgY29uc29sZS5lcnJvcignVGFiIHRhcmdldCBub3QgZm91bmQnKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQhIXRoaXMubGlua3MubGVuZ3RoICYmIHRoaXMubGlua3NbMF0ucGFyZW50Tm9kZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAndGFibGlzdCcpO1xuXG5cdFx0XHR0aGlzLmN1cnJlbnQgPSB0aGlzLnNldHRpbmdzLmFjdGl2ZTtcblxuXHRcdFx0aWYgKGhhc2gpIHtcblx0XHRcdFx0dGhpcy50YXJnZXRzLmZvckVhY2goKHRhcmdldCwgaSkgPT4ge1xuXHRcdFx0XHRcdGlmICh0YXJnZXQuZ2V0QXR0cmlidXRlKCdpZCcpID09PSBoYXNoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmN1cnJlbnQgPSBpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuaW5pdEFyaWEoKVxuXHRcdFx0XHQuaW5pdFRpdGxlcygpXG5cdFx0XHRcdC5vcGVuKHRoaXMuY3VycmVudCk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0aW5pdEFyaWEoKSB7XG5cdFx0XHR0aGlzLmxpbmtzLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWInKTtcblx0XHRcdFx0ZWwuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgZmFsc2UpO1xuXHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCBmYWxzZSk7XG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRoaXMudGFyZ2V0c1tpXS5nZXRBdHRyaWJ1dGUoJ2lkJykpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMudGFyZ2V0cy5mb3JFYWNoKGVsID0+IHtcblx0XHRcdFx0ZWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYnBhbmVsJyk7XG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcblx0XHRcdFx0ZWwuc2V0QXR0cmlidXRlKCd0YWJJbmRleCcsICctMScpO1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGluaXRUaXRsZXMoKSB7XG5cdFx0XHRsZXQgaGFuZGxlciA9IGkgPT4ge1xuXHRcdFx0XHR0aGlzLnRvZ2dsZShpKTtcblx0XHRcdH07XG5cblx0XHRcdHRoaXMubGFzdEZvY3VzZWRUYWIgPSAwO1xuXG5cdFx0XHR0aGlzLmxpbmtzLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cdFx0XHRcdC8vbmF2aWdhdGVcblx0XHRcdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4ge1xuXHRcdFx0XHRcdHN3aXRjaCAoZS5rZXlDb2RlKSB7XG5cdFx0XHRcdFx0Y2FzZSBLRVlfQ09ERVMuVVA6XG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLnRvZ2dsZSgodGhpcy5jdXJyZW50ID09PSAwID8gdGhpcy5saW5rcy5sZW5ndGggLSAxIDogdGhpcy5jdXJyZW50IC0gMSkpO1xuXHRcdFx0XHRcdFx0d2luZG93LnNldFRpbWVvdXQoKCkgPT4geyB0aGlzLmxpbmtzW3RoaXMuY3VycmVudF0uZm9jdXMoKTsgfSwgMTYpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSBLRVlfQ09ERVMuTEVGVDpcblx0XHRcdFx0XHRcdHRoaXMudG9nZ2xlKCh0aGlzLmN1cnJlbnQgPT09IDAgPyB0aGlzLmxpbmtzLmxlbmd0aCAtIDEgOiB0aGlzLmN1cnJlbnQgLSAxKSk7XG5cdFx0XHRcdFx0XHR3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7IHRoaXMubGlua3NbdGhpcy5jdXJyZW50XS5mb2N1cygpOyB9LCAxNik7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlIEtFWV9DT0RFUy5ET1dOOlxuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy50b2dnbGUoKHRoaXMuY3VycmVudCA9PT0gdGhpcy5saW5rcy5sZW5ndGggLSAxID8gMCA6IHRoaXMuY3VycmVudCArIDEpKTtcblx0XHRcdFx0XHRcdHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5saW5rc1t0aGlzLmN1cnJlbnRdLmZvY3VzKCk7IH0sIDE2KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgS0VZX0NPREVTLlJJR0hUOlxuXHRcdFx0XHRcdFx0dGhpcy50b2dnbGUoKHRoaXMuY3VycmVudCA9PT0gdGhpcy5saW5rcy5sZW5ndGggLSAxID8gMCA6IHRoaXMuY3VycmVudCArIDEpKTtcblx0XHRcdFx0XHRcdHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5saW5rc1t0aGlzLmN1cnJlbnRdLmZvY3VzKCk7IH0sIDE2KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgS0VZX0NPREVTLkVOVEVSOlxuXHRcdFx0XHRcdFx0aGFuZGxlci5jYWxsKHRoaXMsIGkpO1xuXHRcdFx0XHRcdFx0d2luZG93LnNldFRpbWVvdXQoKCkgPT4geyB0aGlzLmxpbmtzW2ldLmZvY3VzKCk7IH0sIDE2KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgS0VZX0NPREVTLlNQQUNFOlxuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0aGFuZGxlci5jYWxsKHRoaXMsIGkpO1xuXHRcdFx0XHRcdFx0d2luZG93LnNldFRpbWVvdXQoKCkgPT4geyB0aGlzLmxpbmtzW2ldLmZvY3VzKCk7IH0sIDE2KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgS0VZX0NPREVTLlRBQjpcblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHR0aGlzLmxhc3RGb2N1c2VkVGFiID0gdGhpcy5nZXRMaW5rSW5kZXgoZS50YXJnZXQpO1xuXHRcdFx0XHRcdFx0dGhpcy5zZXRUYXJnZXRGb2N1cyh0aGlzLmxhc3RGb2N1c2VkVGFiKTtcblx0XHRcdFx0XHRcdGhhbmRsZXIuY2FsbCh0aGlzLCBpKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRcdC8vXG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vdG9nZ2xlXG5cdFx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGhhbmRsZXIuY2FsbCh0aGlzLCBpKTsgIFxuXHRcdFx0XHR9LCBmYWxzZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRnZXRMaW5rSW5kZXgobGluayl7XG5cdFx0XHRmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5saW5rcy5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdGlmKGxpbmsgPT09IHRoaXMubGlua3NbaV0pIHJldHVybiBpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fSxcblx0XHRnZXRGb2N1c2FibGVDaGlsZHJlbihub2RlKSB7XG5cdFx0XHRsZXQgZm9jdXNhYmxlRWxlbWVudHMgPSBbJ2FbaHJlZl0nLCAnYXJlYVtocmVmXScsICdpbnB1dDpub3QoW2Rpc2FibGVkXSknLCAnc2VsZWN0Om5vdChbZGlzYWJsZWRdKScsICd0ZXh0YXJlYTpub3QoW2Rpc2FibGVkXSknLCAnYnV0dG9uOm5vdChbZGlzYWJsZWRdKScsICdpZnJhbWUnLCAnb2JqZWN0JywgJ2VtYmVkJywgJ1tjb250ZW50ZWRpdGFibGVdJywgJ1t0YWJJbmRleF06bm90KFt0YWJJbmRleD1cIi0xXCJdKSddO1xuXHRcdFx0cmV0dXJuIFtdLnNsaWNlLmNhbGwobm9kZS5xdWVyeVNlbGVjdG9yQWxsKGZvY3VzYWJsZUVsZW1lbnRzLmpvaW4oJywnKSkpO1xuXHRcdH0sXG5cdFx0c2V0VGFyZ2V0Rm9jdXModGFiSW5kZXgpe1xuXHRcdFx0dGhpcy5mb2N1c2FibGVDaGlsZHJlbiA9IHRoaXMuZ2V0Rm9jdXNhYmxlQ2hpbGRyZW4odGhpcy50YXJnZXRzW3RhYkluZGV4XSk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuZm9jdXNhYmxlQ2hpbGRyZW4ubGVuZ3RoKXtcblx0XHRcdFx0d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdFx0XHR0aGlzLmZvY3VzYWJsZUNoaWxkcmVuWzBdLmZvY3VzKCk7XG5cdFx0XHRcdFx0dGhpcy5rZXlFdmVudExpc3RlbmVyID0gdGhpcy5rZXlMaXN0ZW5lci5iaW5kKHRoaXMpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleUV2ZW50TGlzdGVuZXIpO1xuXHRcdFx0XHR9LmJpbmQodGhpcyksIDApO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0a2V5TGlzdGVuZXIoZSl7XG5cdFx0XHRpZiAoZS5rZXlDb2RlICE9PSBLRVlfQ09ERVMuVEFCKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBmb2N1c2VkSW5kZXggPSB0aGlzLmZvY3VzYWJsZUNoaWxkcmVuLmluZGV4T2YoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7XG5cdFx0XHRcblx0XHRcdGlmKGZvY3VzZWRJbmRleCA8IDApIHtcblx0XHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5RXZlbnRMaXN0ZW5lcik7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoZS5zaGlmdEtleSAmJiBmb2N1c2VkSW5kZXggPT09IDApIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR0aGlzLmZvY3VzYWJsZUNoaWxkcmVuW3RoaXMuZm9jdXNhYmxlQ2hpbGRyZW4ubGVuZ3RoIC0gMV0uZm9jdXMoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmKCFlLnNoaWZ0S2V5ICYmIGZvY3VzZWRJbmRleCA9PT0gdGhpcy5mb2N1c2FibGVDaGlsZHJlbi5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5RXZlbnRMaXN0ZW5lcik7XG5cdFx0XHRcdFx0aWYodGhpcy5sYXN0Rm9jdXNlZFRhYiAhPT0gdGhpcy5saW5rcy5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLmxhc3RGb2N1c2VkVGFiID0gdGhpcy5sYXN0Rm9jdXNlZFRhYiArIDE7XG5cdFx0XHRcdFx0XHR0aGlzLmxpbmtzW3RoaXMubGFzdEZvY3VzZWRUYWJdLmZvY3VzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRjaGFuZ2UodHlwZSwgaSkge1xuXHRcdFx0bGV0IG1ldGhvZHMgPSB7XG5cdFx0XHRcdG9wZW46IHtcblx0XHRcdFx0XHRjbGFzc2xpc3Q6ICdhZGQnLFxuXHRcdFx0XHRcdHRhYkluZGV4OiB7XG5cdFx0XHRcdFx0XHR0YXJnZXQ6IHRoaXMudGFyZ2V0c1tpXSxcblx0XHRcdFx0XHRcdHZhbHVlOiAnMCdcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGNsb3NlOiB7XG5cdFx0XHRcdFx0Y2xhc3NsaXN0OiAncmVtb3ZlJyxcblx0XHRcdFx0XHR0YWJJbmRleDoge1xuXHRcdFx0XHRcdFx0dGFyZ2V0OiB0aGlzLnRhcmdldHNbdGhpcy5jdXJyZW50XSxcblx0XHRcdFx0XHRcdHZhbHVlOiAnLTEnXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHR0aGlzLmxpbmtzW2ldLmNsYXNzTGlzdFttZXRob2RzW3R5cGVdLmNsYXNzbGlzdF0odGhpcy5zZXR0aW5ncy5jdXJyZW50Q2xhc3MpO1xuXHRcdFx0dGhpcy50YXJnZXRzW2ldLmNsYXNzTGlzdFttZXRob2RzW3R5cGVdLmNsYXNzbGlzdF0odGhpcy5zZXR0aW5ncy5jdXJyZW50Q2xhc3MpO1xuXHRcdFx0dGhpcy50YXJnZXRzW2ldLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAhdGhpcy50YXJnZXRzW2ldLmdldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKSk7XG5cdFx0XHR0aGlzLmxpbmtzW2ldLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICF0aGlzLnRhcmdldHNbaV0uZ2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJykpO1xuXHRcdFx0dGhpcy5saW5rc1tpXS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAhdGhpcy50YXJnZXRzW2ldLmdldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpKTtcblx0XHRcdG1ldGhvZHNbdHlwZV0udGFiSW5kZXgudGFyZ2V0LnNldEF0dHJpYnV0ZSgndGFiSW5kZXgnLCBtZXRob2RzW3R5cGVdLnRhYkluZGV4LnZhbHVlKTtcblx0XHRcdFxuXHRcdH0sXG5cdFx0b3BlbihpKSB7XG5cdFx0XHR0aGlzLmNoYW5nZSgnb3BlbicsIGkpO1xuXHRcdFx0dGhpcy5jdXJyZW50ID0gaTtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0Y2xvc2UoaSkge1xuXHRcdFx0dGhpcy5jaGFuZ2UoJ2Nsb3NlJywgaSk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHRvZ2dsZShpKSB7XG5cdFx0XHRpZih0aGlzLmN1cnJlbnQgPT09IGkpIHJldHVybjtcblxuXHRcdFx0d2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKHsgVVJMOiB0aGlzLmxpbmtzW2ldLmdldEF0dHJpYnV0ZSgnaHJlZicpIH0sICcnLCB0aGlzLmxpbmtzW2ldLmdldEF0dHJpYnV0ZSgnaHJlZicpKTtcblxuXHRcdFx0aWYodGhpcy5jdXJyZW50ID09PSBudWxsKSB7XG5cdFx0XHRcdHRoaXMub3BlbihpKTtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmNsb3NlKHRoaXMuY3VycmVudClcblx0XHRcdFx0Lm9wZW4oaSk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0fTtcblxuXG5jb25zdCBpbml0ID0gKHNlbCwgb3B0cykgPT4ge1xuXHRsZXQgZWxzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbCkpO1xuXHRcblx0aWYoIWVscy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignVGFicyBjYW5ub3QgYmUgaW5pdGlhbGlzZWQsIG5vIGF1Z21lbnRhYmxlIGVsZW1lbnRzIGZvdW5kJyk7XG5cblx0cmV0dXJuIGVscy5tYXAoKGVsKSA9PiB7XG5cdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShTdG9ybVRhYnMpLCB7XG5cdFx0XHRET01FbGVtZW50OiBlbCxcblx0XHRcdHNldHRpbmdzOiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0cywgb3B0cylcblx0XHR9KS5pbml0KCk7XG5cdH0pO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgeyBpbml0IH07Il19
